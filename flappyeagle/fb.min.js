function is_touch_device(){try{document.createEvent("TouchEvent");return true}catch(e){return false}}function easyMode(){easy.style["box-shadow"]="0 0 0 2px #165CF3";normal.style["box-shadow"]="";hard.style["box-shadow"]="";clearInterval(animation);dropSpeed=.3;mode=0;delta=100;initCanvas()}function normalMode(){easy.style["box-shadow"]="";normal.style["box-shadow"]="0 0 0 2px #165CF3";hard.style["box-shadow"]="";clearInterval(animation);dropSpeed=.3;mode=1;delta=0;initCanvas()}function hardMode(){easy.style["box-shadow"]="";normal.style["box-shadow"]="";hard.style["box-shadow"]="0 0 0 2px #165CF3";clearInterval(animation);dropSpeed=.3;mode=2;delta=0;initCanvas()}var canvas,ctx;var width,height,birdPos;var sky,land,bird,pipe,pipeUp,pipeDown,scoreBoard,ready,splash;var dist,birdY,birdF,birdN,birdV;var animation,death,deathAnim;var pipes=[],pipesDir=[],pipeSt,pipeNumber;var score,maxScore;var dropSpeed;var mode,delta;var clearCanvas=function(){ctx.fillStyle="#4EC0CA";ctx.fillRect(0,0,width,height)};var loadImages=function(){var e=9,t=0;var n=function(){t++;if(t==e){death=1;dist=0;birdY=(height-112)/2;birdF=0;birdN=0;birdV=0;birdPos=width*.35;score=0;pipeSt=0;pipeNumber=10;pipes=[];pipesDir=[];for(var n=0;n<10;++n){pipes.push(Math.floor(Math.random()*(height-300-delta)+10));pipesDir.push(Math.random()>.5)}drawCanvas()}};sky=new Image;sky.src="images/sky.png";sky.onload=n;land=new Image;land.src="images/land.png";land.onload=n;bird=new Image;bird.src="images/bird.png";bird.onload=n;pipe=new Image;pipe.src="images/pipe.png";pipe.onload=n;pipeUp=new Image;pipeUp.src="images/pipe-up.png";pipeUp.onload=n;pipeDown=new Image;pipeDown.src="images/pipe-down.png";pipeDown.onload=n;scoreBoard=new Image;scoreBoard.src="images/scoreboard.png";scoreBoard.onload=n;ready=new Image;ready.src="images/replay.png";ready.onload=n;splash=new Image;splash.src="images/splash.png";splash.onload=n};var initCanvas=function(){canvas=document.getElementById("canvas");ctx=canvas.getContext("2d");canvas.width=width=window.innerWidth;canvas.height=height=window.innerHeight;if(is_touch_device()){canvas.addEventListener("touchend",function(e){e.preventDefault()},false);canvas.addEventListener("touchstart",function(e){jump();e.preventDefault()},false)}else canvas.onmousedown=jump;window.onkeydown=jump;FastClick.attach(canvas);loadImages()};var deathAnimation=function(){if(splash){ctx.drawImage(splash,width/2-94,height/2-54);splash=undefined}else ctx.drawImage(scoreBoard,width/2-118,height/2-54);ctx.drawImage(ready,width/2-57,height/2+10);maxScore=Math.max(maxScore,score)};var drawSky=function(){var e=0;while(e<width){ctx.drawImage(sky,e,height-221);e+=sky.width}};var drawLand=function(){var e=-dist;while(e<width){ctx.drawImage(land,e,height-112);e+=land.width}dist=dist+2;var t=Math.floor(dist-width*.65)%220;if(dist>=width*.65&&Math.abs(t)<=1){score++}};var drawPipe=function(e,t){ctx.drawImage(pipe,e,0,pipe.width,t);ctx.drawImage(pipeDown,e,t);ctx.drawImage(pipe,e,t+168+delta,pipe.width,height-112);ctx.drawImage(pipeUp,e,t+144+delta);if(e<birdPos+34&&e+52>birdPos&&(birdY<t+24||birdY+24>t+144+delta)){clearInterval(animation);death=1}else if(e+40<0){pipeSt++;pipeNumber++;pipes.push(Math.floor(Math.random()*(height-300-delta)+10));pipesDir.push(Math.random()>.5)}};var drawBird=function(){ctx.drawImage(bird,0,birdN*24,bird.width,bird.height/4,birdPos,birdY,bird.width,bird.height/4);birdF=(birdF+1)%6;if(birdF%6==0)birdN=(birdN+1)%4;birdY-=birdV;birdV-=dropSpeed;if(birdY+138>height){clearInterval(animation);death=1}if(death)deathAnimation()};var drawScore=function(){ctx.font='20px "Press Start 2P"';ctx.lineWidth=5;ctx.strokeStyle="#fff";ctx.fillStyle="#000";var e=""+score;ctx.strokeText(e,(width-ctx.measureText(e).width)/2,height*.15);ctx.fillText(e,(width-ctx.measureText(e).width)/2,height*.15)};var drawCanvas=function(){clearCanvas();drawSky();for(var e=pipeSt;e<pipeNumber;++e){drawPipe(width-dist+e*220,pipes[e]);if(mode==2){if(pipesDir[e]){if(pipes[e]+1>height-300){pipesDir[e]=!pipesDir[e];pipes[e]-=1}else pipes[e]+=1}else{if(pipes[e]-1<10){pipesDir[e]=!pipesDir[e];pipes[e]+=1}else pipes[e]-=1}}}drawLand();drawBird();drawScore()};var anim=function(){animation=setInterval(drawCanvas,1e3/60)};var jump=function(){if(death){dist=0;birdY=(height-112)/2;birdF=0;birdN=0;birdV=0;death=0;score=0;birdPos=width*.35;pipeSt=0;pipeNumber=10;pipes=[];pipesDir=[];for(var e=0;e<10;++e){pipes.push(Math.floor(Math.random()*(height-300-delta)+10));pipesDir.push(Math.random()>.5)}anim()}if(mode==0)birdV=6;else birdV=6};var easy,normal,hard;window.onload=function(){maxScore=0;dropSpeed=.3;mode=0;delta=100;initCanvas();easy=document.getElementById("easy");easy.onclick=easyMode;normal=document.getElementById("normal");normal.onclick=normalMode;hard=document.getElementById("hard");hard.onclick=hardMode}